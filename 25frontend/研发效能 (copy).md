### 云平台可信作业流   

相比流水线的openstack升级：更灵活，自定义，更全面的

受益部门：计算服务产品部，存储服务产品部，SRE部门

伏羲提供e2e可信方案，协助云平台缺陷追踪，构建、测试、发布、升级端到端可追溯，实现计算服务产品部6个域96个服务现网升级，

发布计划管理，将很多条流水线缩短到几条发布流，高效管理版本发布，通过发布计划安全可靠的发布版本，实现端到端的可信发布，全流程可追溯，支持发布计划动态调整

缩短构建时间，提升发布效率，

支持ring环约束，可靠掌握发布流的

对扩展开放，对内收敛

### 工作经历

1. 负责CloudDevOps平台的开发，持续输出高质量可维护可扩展的代码，保证业务的高质量落地。

2. 负责工作项的整个生命周期，高效推动工作项的进展，独立将工作项从需求到开发到beta测试、灰度测试、生产测试到上线维护整个流程端到端闭环

1. 使用前端框架和组件库，开发用于公司业务系统的组件库和案例系统，优化框架软件界面，兼容主流的浏览器
2. 参与技术选型和产品发布交付并撰写相关的文档，与其他项目组团队紧密协作，解决他们使用组件库遇到的问题，确保软件实施

### 项目经历

在团队开展技术分享，负责公司的技术分享会以及前端代码review会议

丰富部门的组件库和项目架构模板





基于微前端架构的大型DevOps平台，使用Element-UI组件库，打造一套研发生产高效工作流，主要工作内容：

1. 独立负责子应用云平台Cloud Platform Release的开发和维护，对OpenStack下的服务升级，实现云平台稳定的可信作业流，保证线上无bug。实现为计算服务产品部，存储服务产品部等受益部门6个域的现网服务升级，版本可信发布，端到端可追溯。
2. 完成子应用云平台的发布计划、任务运行等核心代码的编写，实现发布计划的展示、编辑、定时执行计划，任务的执行、重试、升级、添加，优化任务运行、环境视图等常用页面的性能，增加自动化的交互方式，提升开发人员的使用体验。
3. 负责主应用CloudDevOps的部署模块的开发，完成集成流水线的不同部署系统的对接。重构主应用部署模块部分核心页面和环境模块部署模板页面，提高页面的复用性和可扩展性，减少单文件代码数量，相关代码更清晰可维护，实现页面性能有效提升。通过代码压缩，在3G网络下页面打开速度提升50%，使用ele-form动态表单实现DevOps部署标准化。
4. 负责静态资源代码库的迁移和中心仓的维护和其他主应用下其他子应用的开发和维护。

开发组件库并实现一套案例系统方便开发人员参考，将工程中组件库部分打包发布在研发内网供其它团队使用，主要工作任务：

1. 完成案例系统布局模块并作为布局组件，实现主题换肤功能，完成了登录等页面，添加了路由导航守卫。
2. 完成了符合业务需求的动态表格和表单组件，表格和表单组件使用模板数据自动生成，表单完成了分栏、视图替换、自定义触发事件、分组等功能，表格完成了展开行、行内编辑、树形表格等功能，封装了Echarts和G6组件。完善公共服务和配置，常用工具方法。
3. 解决测试团队提出的bug，编写脚本打包应用发布版本，给研发部六个部门使用，高效对接其他部门的相关业务。

基于微前端架构的大型DevOps平台，使用Element-UI组件库，打造一套研发生产高效工作流，主要工作内容：

1. 独立负责子应用云平台(OpenStack Platform Release)的开发和维护，实现对OpenStack下服务的升级，完成发布流核心代码的编写，完成发布计划的编辑，实现稳定的发布，完成CPS核心代码的编写，云平台可信作业流，伏羲提供e2e可信方案，协作云平台缺陷追踪，端到端可追溯，完成核心代码的编写，提升发布速度70%
2. 负责主应用CloudDevOps部署模块，集成流水线，重构主应用部署模块部分页面，环境页面重写 实现页面的复用，实现页面效率大大提升，大大提升用户体验，使用压缩，提升项目在3g网络下页面打开速度50%
3. 使用ele-form动态表单实现DevOps部署标准化，达到通用的目的
4. 负责静态资源代码库三方库的整改和主应用下其他部分子应用的维护

开发组件库并实现一套案例系统方便开发人员参考，将工程中组件库打包发布在研发内网供其它团队使用，主要工作任务：

1. 完成案例系统布局模块并作为布局组件，主题换肤功能提供了五套皮肤的，通过服务一键切换，完成了登录页，添加路由导航守卫。
2. 模板表格和表单通过数据自动生成，表单完善分栏、视图替换、自定义触发事件、分组等功能，表格完善展开行、行内编辑、树形表格等功能，封装Echarts和G6组件。完善公共服务和配置，常用工具方法，包括http服务，缓存服务，校验函数等。
3. 解决测试团队提出的bug，编写脚本打包应用发布版本，给研发部六个部门使用。

 



#### 软件开发平台由以下几个主要服务构成：

- 项目管理：软件开发团队提供敏捷项目管理与协作，支持多项目管理、敏捷迭代管理、里程碑管理、需求管理、缺陷跟踪、多维度统计报表等功能。
- 代码托管：面向软件开发者的基于Git的在线代码托管服务，是具备安全管控、成员/权限管理、分支保护/合并、在线编辑、统计服务等功能的云端代码仓库，旨在解决软件开发者在跨地域协同、多分支并发、代码版本管理、安全性等方面的问题。
- 流水线：集成了很多功能，很多功能都通过流水线承载起来了，静态资源和普通的工程代码，提供可视化、可定制的自动交付流水线，帮助企业缩短交付周期，提升交付效率。
- 代码检查：基于云端实现代码质量管理，软件开发者可在编码完成后执行多语言的代码静态检查和安全检查，获取全面的质量报告，并提供缺陷的分组查看与改进建议，有效管控代码质量，帮助产品成功。
- 编译构建：开发者提供配置简单的混合语言构建平台，实现编译构建云端化，支撑企业实现持续交付，缩短交付周期，提升交付效率。支持编译构建任务一键创建、配置和执行，实现获取代码、构建、打包等活动自动化，实时监控构建状态，让您更加快速、高效地进行云端编译构建。
- 部署：提供可视化、一键式部署服务，支持部署到虚拟机或者容器，提供Tomcat、SpringBoot等模板或者自由组装编排原子步骤进行部署，支持并行部署和流水线无缝集成，实现部署环境标准化和部署过程自动化。
- 云测：面向软件开发者提供一站式云端测试平台，覆盖功能测试、接口测试，融入DevOps敏捷测试理念，高效管理测试活动，保障产品高质量交付。
- 发布：为软件开发团队提供管理软件发布过程的能力，保障软件发布过程的规范化、可视化及可追溯。
- CloudIDE：云端开发环境。向开发者提供按需配置、快速获取的工作空间（包含编辑器和运行环境），支持完成环境配置、代码阅读、编写代码、构建、运行、调试、预览等操作，并支持对接多种代码仓库。
- 开源镜像站（提供构建依赖）：由华为云提供的开源组件、开源操作系统及开源DevOps工具镜像站，致力为用户提供全面、高速、可信的开源组件/OS/工具下载服务。

**服务名 ** 和 **功能特性**

项目管理

提供多项目管理、敏捷迭代管理、里程碑管理、需求管理、缺陷跟踪、多维度统计报表等功能。

- 迭代计划和时间线，有效管理项目计划。
- 树表、任务墙等多种视图，方便查看项目工作。
- 多种项目统计图表，随时掌握项目开展情况。
- 批量文档托管，信息传递不失真。

代码托管

提供安全、可靠、高效的分布式代码托管服务。包括代码克隆/下载/提交/推送/比较/合并/分支等功能。

- 专属云存储，全网TLS传输，角色权限管控等技术，网络安全团队专业认证，保证云上代码安全。
- 异地容灾，实时备份，快速恢复，定期演练，保障核心资产万无一失。
- 基于Git的分布式版本控制，提升跨地域跨团队协同开发效率。
- 关联项目任务，保障项目高效交付。
- 增强的安全防护能力，IP白名单与代码仓库访问日志审计。
- 代码仓库提交信息统计， 代码仓库贡献者统计， 个人贡献里程碑。

流水线

提供可视化、可定制的端到端自动交付流水线，缩短交付周期，提升交付效率。

- 业务流程按需制定，分层分级灵活编排，实时监控流水线状态。
- 集成代码拉取、代码检查、编译构建、部署等任务。
- 集成自动化质量门禁，保障软件交付质量。
- 集成jenkins调度任务，支持构建线上线下混合流水线。
- 定时执行、提交代码自动触发等特色功能满足用户不同使用场景。

代码检查

提供可协作的一站式深度代码检查服务。

- 一站式：覆盖主流编程语言、主流编码标准、SDLC集成等。
- 深度检查：支持跨函数的深度检查、准确定位到代码缺陷所在行。
- 可协作：提供问题责任人自动归属、提供问题修改建议、可聚焦处理新问题等。

编译构建

快速，安全，弹性可扩展的云上编译构建服务。

- 开箱即用：提供标准化的云上环境，支持主流语言，多种构建框架。
- 灵活可扩展：全容器化构建，支持自定义构建环境；构建步骤可灵活编排；弹性可扩展的云上资源；支持软件开发平台代码托管、GitHub、通用Git等代码源。
- 快速：全局、租户的多级缓存；无缝对接开源镜像站，更快的获取依赖包。

部署

提供可视化、一键式部署服务，支持并行部署和流水线无缝集成，实现部署环境标准化和部署过程自动化，提升部署效率。

- 基于预定义的或可定制的模板，实现主流应用一键式部署。
- 支持多应用，多目标主机的并行部署。
- 通过系统模板与25+部署步骤来灵活支撑各种部署场景 。
- 支持将应用部署到物理机、云主机、容器等，也同时支持Tomcat、SpringBoot、Nodejs等多种技术栈的部署。

云测

提供一站式测试解决方案，覆盖功能测试、接口测试、性能测试，多维度评估产品质量，帮助用户高效管理测试活动，保障产品高质量交付。

- 一站式云端测试平台，覆盖测试管理、接口测试、性能测试，高效协同，一站式开展用例设计、测试执行、缺陷提交、生成报告，提高测试效率。
- 云端高效自动化测试，快速编排测试用例，集成流水线，支持微服务测试、分层自动化测试等多种测试场景。
- 全生命周期追溯和可视化，需求-用例-缺陷双向追溯，测试有的放矢，多角色高效协同，多维度产品质量看板，全方位评估产品质量，保障产品高效验收。

发布

提供软件发布管理的云服务，提供软件仓库、软件发布、发布包上传/下载、发布包元数据管理功能，通过安全可靠的软件仓库，实现软件包版本管理，提升发布质量和效率，实现产品的持续发布。

- 支持文件重命名、批量删除、批量恢复、页面上传和下载、文件名搜索等文件操作。
- 编译构建属性自动关联软件包，编译构建的产物自动归档到软件发布库。
- 支持构建服务快速上传、部署服务从发布库快速获取软件包。
- 提供目录、构建和发布三种视图来支持用户进行软件包生命周期追溯。

移动应用测试

提供移动兼容性测试服务。提供TOP流行机型、数百名测试专家，使用图像识别和精准控件识别技术，只需提供App/H5/快应用/小程序应用，便可生成兼容性测试报告（包含系统日志、截图、错误原因、CPU、内存等），自动完成测试任务。

- 提供丰富Android、iOS真机，全自动化测试，无需人工编写用例。
- 深度优化的遍历算法，可以测试安装、启动、崩溃、无响应等11大问题类型。
- 提供详尽在线测试报告，帮助用户快速定位修复问题。

CloudIDE

CloudIDE是软件开发平台的云端开发环境服务，向开发者提供按需配置、快速获取的工作空间（包含编辑器和运行环境），支持完成环境配置、代码阅读、编写代码、构建、运行、调试、预览等操作，并支持对接多种代码仓库。

- 依托云端的计算和存储资源，实现云化开发环境供给；基于全容器技术，可按用户所需配置启动并提供工作空间。
- 支持40多种语言的语法高亮，支持Java等语言的语法补齐，支持7种预置技术栈，无需复杂配置环境即可就位。
- 提供页面终端（WebTerminal）直接访问后端容器环境，支持线上构建（build）、运行（run）和调试（debug）。
- 对接Git仓库（软件开发平台代码仓库或GitHub等），同时提供环境对接其他开放服务的通道。
- 提供基于黑白名单的访问控制能力，为企业租户提供掌控子用户行为的管理面。



#### 容器

- 灵活：即使是最复杂的应用也可以集装箱化。
- 轻量级：容器利用并共享主机内核。
- 可互换：您可以即时部署更新和升级。
- 便携式：您可以在本地构建，部署到云，并在任何地方运行。
- 可扩展：您可以增加并自动分发容器副本。
- 可堆叠：您可以垂直和即时堆叠服务。

镜像和容器（containers）:

通过镜像启动一个容器，一个镜像是一个可执行的包，其中包括运行应用程序所需要的所有内容包含代码，运行时间，库、环境变量、和配置文件。容器是镜像的运行实例，当被运行时有镜像状态和用户进程，可以使用docker ps 查看。 

镜像是容器的基础，容器基于镜像定义的内容来运行。镜像是多层存储，每一层是前一层基础上进行的修改。定制镜像时，一般使用Dockerfile来完成。Dockerfile是一个文本文件，其内包含了一条条的指令，每一条指令构建镜像的其中一层，因此每一条指令的内容，就是描述该层应该如何构建。

pass：k8s docker 容器

iass：openstack kvm 虚拟机/物理机/网络



### 字节  

**技术中台化、技术工具多**

-  什么是技术中台化，最简单的例子，data部门会给整个字节的各条业务提供数据能力支撑，内部的各种中台都能给业务开发提供非常便捷的支持保障。**中台化****的****一大利好就是，内部有非常多的便捷效率工具。**例如风神 、grafana等开发工具，这些都极大减少了日常开发的成本。其次字节内部的字节云包含了非常丰富的开发工具，例如代码编译发行的SCM TCE、链路分析日志检索的Argos、业务流水线bytecycle以及成熟的报警处理工具等等。而且各个工具都有相应的产品文档、oncall答疑群，能非常便利地供业务开发使用。 
-  另外，内部的代码仓库也都可以申请查看。字节主线产品多，新赛道都在持续发力中，如果对其他业务感兴趣的话，都可以浏览学习其他业务的核心代码。 

**流程规范**

-  从产品的prd到上线验收，全流程都绑定在meego流程管理上，字节从开发流程上说是非常规范的。包括自己写的代码，在提测之前都需要和QA同学与FO(方向负责人)拉会，讲解自己的编码思路和逻辑、技术实现方法。通过code review来最大程度避免个人在开发中会有遗漏的case，FO同学也会就代码质量提出自己的意见。 



#### 工程化

建立统一的项目模版，然后通过 cli 来选择 项目模版，模版选择后，直接生成项目，然后把调用 gitlab 的 api， 在 gitlab 上创建项目，push项目，这样就收拢了大家创建项目的方式， 自动统一了代码规范

持续集成，完成 push => 构建 => 上传oss（或者静态资源服务器,自动绑定域名，接 cdn，这样一条龙的服务，人手够的话也可以把 2，3结合一起做成基于 GUI 网页的创建，因为这里接管了大家发布代码的规范，后面就可以干很多事了

把内部的 npm 私服搭建起来，做一套内网的 npm 组件开发构建  publish 一条龙服务，建一个组件展示平台，这样人多了，大家接可以互相用起来，方便的很

因为有了上面 3 的收拢，我们就可以上线代码风格校验，检测线上发布是否包含了 sourcemap文件，接着人手够，老板支持的话，可以统计每个项目的依赖，存储到数据库，这样某天某个第三方出了问题（比方包含了挖矿脚本），就能立马找到那个项目依赖了，对于内部 npm 组件，谁使用了，也是很清晰，这样组件更新了，也可以企微，钉钉，邮件的方式自动通知到使用方，再大胆些，还可以每次发布前通过  puppeteer  跑下项目，统计了 性能数据，和之前的数据对比下，偏差太大也可以通知到对应负责人，让他检查下

#### 监控

建立监控体系，监控体系可以简单，可以复杂，看领导的支持度，最基础的功能是，做 pageLoader 监控，意思是页面加载成功后上报下数据，表明当前页面是正常的，这样每次上线后，就通过消息通知到开发去观察 pageLoader 曲线的变化，这样就不会发布后， 2 眼一抹黑，也不知道线上是个什么情况，出了问题，也可以通过 gitlab ci/cd 立马回滚代码，这个是个很强的需求，基本上老板肯定是支持的，那线上出了错也不知道是啥子错，咋办，那我们把 线上错误上报上来，就很直观了，还可以结合 sourcemap 把错误和打包前的文件映射起来，便于定位问题，没人手就用开源的有 sentry，有人手的就自己开发

监控建立起来了，是不是得做个报警机制啊，比方某个桥接更新了，和之前的不兼容，之前运行好好的的页面一直报错，错误上报达到一定量就报警起来，那就去把上报的数据捞起来做个统计分析，还可以结合 prometheus，做个好看展示曲线

既然错误监控都做了，那把页面性能监控也做了吧

哎，咋监控后性能数据这么差，是哪里出了问题，哦，打包文件太大，那 Webpack  得好好学习下，怎么拆分，啊，发现 http 请求时间太常，是不是 CDN 哪里出了问题，是不是资源没开启压缩，那这个链路还不熟，得好好学习下

什么前端的监控都给做了，能不能协助下客户端的同学，把他们的 crash 上报，冷启监控都给做下

#### 后端

要做上面这些，至少需要会门后端语言，会数据库啊，我擦，刚好上手 Egg.js Mysql 开发啊，之前不是学习 Node.js 没有场景使用么，一下子这么多场景来了，刚好带薪学习

我擦，接了前端，客户端上报，请求数量一下子上来了，随手写的垃圾 Egg 代码，性能跟不上了，加班优化吧，不然不被骂死，还不行，加机器吧，加机器要做负载均衡啊，这个不会啊，赶紧学习去，是不是还需要做缓存，那还得学习下 Redis

活动页天天写，可是有很多落地页都是非常简单的，每次都得 copy  个项目，然后改改图片，改改样式，太烦了，没有成长啊，那要不我来整个托拉拽生成页面，把这些页面元素都独立成组件，让运营自己去拖动，生成她需要的，这不就是个 就是时髦的 「可视化搭建么」把自己解放出来

简单的落地页可以这样做，那难的活动页咋办，比如 大转盘，红包雨，发现这些活动复杂些，简单的搭建不好解决，但是发现，这些好像也可以抽象，抽象成玩法的概念，那得加个配置中心来配置玩法

发现每个项目组活动页有自己不同的 api，还有些活动会用相同的api，怎么办，每个人还不一样，我擦，这样配置中心用起来太麻烦了，是不是做个服务平台，把这些 API 都包成 BaaS，然后想用的人 自己写写代码来组合 api ，那这个要用 Fass 了，额，一步小心，做了个粗糙版的  Serverless

### **Q2。DevOps有什么需求？**

这个答案应该从解释总体市场趋势开始。公司没有发布大量功能，而是尝试查看是否可以通过一系列发布系列将小的功能传输给客户。这具有许多优点，例如来自客户的快速反馈，更好的软件质量等，从而导致很高的客户满意度。为此，公司必须：

1. 增加部署频率
2. 降低新版本的失败率
3. 缩短了两次版本之间的交付时间
4. 新版本崩溃时平均恢复时间更快

DevOps满足所有这些要求，并有助于实现无缝的软件交付。您可以举一些像Etsy，ali，Google和Amazon这样的公司的例子，这些公司采用DevOps来达到甚至五年前都无法想象的性能水平。他们每天进行数十，数百甚至数千个代码部署，同时提供世界一流的稳定性，可靠性和安全性。

